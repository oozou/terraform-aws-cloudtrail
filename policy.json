{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AWSCloudTrailAclCheck",
      "Effect": "Allow",
      "Principal": {
        "Service": "cloudtrail.amazonaws.com"
      },
      "Action": "s3:GetBucketAcl",
      "Resource": "arn:aws:s3:::security-centralized-trails-291232806360"
    },
    {
      "Sid": "Allow cross-account access for CloudTrail check",
      "Effect": "Allow",
      "Principal": {
        "AWS": [
          "arn:aws:iam::280161960322:root",
          "arn:aws:iam::701447773832:root",
          "arn:aws:iam::494578072639:root",
          "arn:aws:iam::686184453429:root",
          "arn:aws:iam::291232806360:root"
        ]
      },
      "Action": [
        "s3:GetObjectVersionAcl",
        "s3:GetBucketLogging",
        "s3:GetBucketPolicy",
        "s3:GetBucketAcl"
      ],
      "Resource": [
        "arn:aws:s3:::security-centralized-trails-291232806360",
        "arn:aws:s3:::security-centralized-trails-291232806360/AWSLogs/*"
      ]
    },
    {
      "Sid": "AWSCloudTrailWrite",
      "Effect": "Allow",
      "Principal": {
        "Service": "cloudtrail.amazonaws.com"
      },
      "Action": "s3:PutObject",
      "Resource": [
        "arn:aws:s3:::security-centralized-trails-291232806360/AWSLogs/280161960322/*",
        "arn:aws:s3:::security-centralized-trails-291232806360/AWSLogs/701447773832/*",
        "arn:aws:s3:::security-centralized-trails-291232806360/AWSLogs/494578072639/*",
        "arn:aws:s3:::security-centralized-trails-291232806360/AWSLogs/686184453429/*",
        "arn:aws:s3:::security-centralized-trails-291232806360/AWSLogs/291232806360/*"
      ],
      "Condition": {
        "StringEquals": {
          "s3:x-amz-acl": "bucket-owner-full-control"
        }
      }
    },
    {
      "Sid": "DenyDeleteObject",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:Delete*",
      "Resource": [
        "arn:aws:s3:::security-centralized-trails-291232806360",
        "arn:aws:s3:::security-centralized-trails-291232806360/*"
      ]
    },
    {
      "Sid": "DenyIncorrectEncryptionHeader",
      "Effect": "Deny",
      "Principal": {
        "AWS": "*"
      },
      "Action": "s3:PutObject",
      "Resource": "arn:aws:s3:::security-centralized-trails-291232806360/*",
      "Condition": {
        "StringNotEquals": {
          "s3:x-amz-server-side-encryption": [
            "aws:kms",
            "AES256"
          ]
        }
      }
    },
    {
      "Sid": "DenyUnEncryptedObjectUploads",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:PutObject",
      "Resource": "arn:aws:s3:::security-centralized-trails-291232806360/*",
      "Condition": {
        "Null": {
          "s3:x-amz-server-side-encryption": "true"
        }
      }
    }
  ]
}
